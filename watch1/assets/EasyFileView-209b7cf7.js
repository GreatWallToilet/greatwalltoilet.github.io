import{ad as W,r as g,ae as E,l as B,E as L,a3 as w,af as U,_ as p,b as a,c as i,d as l,ag as Z,X as P,H as c,P as h,$ as T,G as I,ah as F,t as S,ai as G,a6 as j,D as y,F as N,a4 as O,a8 as z,a9 as H,aa as K,aj as X,w as J,o as Q,ak as Y}from"./index-5b1ebc59.js";const ee=W("global",()=>{const e=g(!1);return{isWebToMpRedirectEnable:e,fetchWebToMpRedirectEnable:async()=>{try{e.value=await E.fetchIsWebToMpRedirectEnable()}catch(t){console.error(t)}}}}),te=e=>{const n=ee(),t=B(()=>n.isWebToMpRedirectEnable),r=["image/gif","image/jpeg","image/png","image/svg+xml","image/webp"],u=["video/mp4"],f=["text/markdown","text/x-markdown","application/x-markdown","text/markdown; charset=utf-8","text/x-markdown; charset=utf-8","text/vnd.daringfireball.markdown","text/plain","text/plain; charset=utf-8"],d=g(0),_=g({}),m=g(!1),k=g(!1),b=g(!1),A=B(()=>{const o=_.value.content_type;return r.includes(o)?"image":u.includes(o)?"video":f.includes(o)?"markdown":"other"}),M=async()=>{try{const s=(await E.getEasyFile(e))[0];if(_.value=s,b.value=s.is_banned==1,s.in_recycle_bin==1){d.value=-1;return}s.is_transcoded==!0?d.value=await U.getCdnUrl(s.transcoded_kodo_key):s.kodo_key!==""&&s.kodo_key!==void 0?d.value=await U.getCdnUrl(s.kodo_key):s.oss_url!==""&&s.oss_url!==void 0&&(d.value=s.oss_url)}catch{d.value=-1}},V=()=>window.navigator.userAgent.toLowerCase().match(/MicroMessenger/i)=="micromessenger",R=async()=>{if(V())L({message:"\u8BF7\u5728\u9ED8\u8BA4\u6D4F\u89C8\u5668\u4E2D\u6253\u5F00\u4EE5\u5F00\u59CB\u4E0B\u8F7D",type:"info",duration:5e3});else try{const o=document.createElement("a");o.style.display="none",o.href=d.value,o.download=_.value.name,document.body.appendChild(o),o.click(),document.body.removeChild(o)}catch(o){console.error(o)}},$=()=>new URLSearchParams(window.location.search).get("download"),v=async()=>{const o=await E.getUrlScheme("index"),s=encodeURIComponent(`type=file&url=${e}`);console.log("urlScheme",`${o}&cq=${s}`),location.href=`${o}&cq=${s}`};return{state:{fileUrl:d,fileType:A,easyFile:_,isDownload:m,isMobile:k,isBanned:b,isWebToMpRedirectEnable:t},action:{handleReport:async(o,s)=>{try{await o.confirm("\u662F\u5426\u4E3E\u62A5\u8BE5\u6587\u4EF6\uFF1F","\u4E3E\u62A5\u6587\u4EF6",{confirmButtonText:"\u4E3E\u62A5",cancelButtonText:"\u53D6\u6D88",type:"warning"}),await E.createReport(_.value.object_id),s({message:"\u5DF2\u5B8C\u6210\u4E3E\u62A5\uFF0C\u6211\u4EEC\u4F1A\u5C3D\u5FEB\u5BA1\u6838",type:"success"})}catch{}},handleOpenMiniProgram:v,handleDownload:R,initialize:async()=>{await n.fetchWebToMpRedirectEnable(),k.value=w.platform()==="mobile-web",await M(),!b.value&&($()?m.value=!0:k.value&&t.value&&v())}}}},ne={},ae={xmlns:"http://www.w3.org/2000/svg",width:"38.353",height:"34.998",viewBox:"0 0 38.353 34.998"};function oe(e,n){return a(),i("svg",ae,n[0]||(n[0]=[l("g",{id:"\u7EC4_993","data-name":"\u7EC4 993",transform:"translate(-68.175 -100.4)"},[l("path",{id:"\u8DEF\u5F84_359","data-name":"\u8DEF\u5F84 359",d:"M99.788,135.4H74.911a6.725,6.725,0,0,1-5.824-10.088l12.44-21.545a6.729,6.729,0,0,1,11.656,0l12.432,21.541A6.729,6.729,0,0,1,99.788,135.4ZM87.352,104.223a2.874,2.874,0,0,0-2.514,1.45L72.4,127.218a2.9,2.9,0,0,0,2.514,4.353H99.788a2.9,2.9,0,0,0,2.514-4.353l-12.44-21.545A2.867,2.867,0,0,0,87.352,104.223Zm-4.171.5h0Z",transform:"translate(0 0)",fill:"#fff"}),l("path",{id:"\u8DEF\u5F84_360","data-name":"\u8DEF\u5F84 360",d:"M471.953,663.853m-2.153,0a2.153,2.153,0,1,0,2.153-2.153A2.153,2.153,0,0,0,469.8,663.853Z",transform:"translate(-384.601 -537.508)",fill:"#fff"}),l("path",{id:"\u8DEF\u5F84_361","data-name":"\u8DEF\u5F84 361",d:"M477.412,404.056a1.912,1.912,0,0,1-1.912-1.912v-5.832a1.912,1.912,0,1,1,3.823,0v5.832A1.912,1.912,0,0,1,477.412,404.056Z",transform:"translate(-390.06 -281.538)",fill:"#fff"})],-1)]))}const ie=p(ne,[["render",oe]]);const se=["src"],re=["src"],le={__name:"EasyBackground",setup(e){const n=Z(),t=P(),r=()=>{t.push("/")};return(u,f)=>(a(),i(T,null,[c(n).backgroundImage?(a(),i("img",{key:0,class:"background",src:c(n).backgroundImage},null,8,se)):h("",!0),c(n).logoNewImage?(a(),i("img",{key:1,class:"logo-new",src:c(n).logoNewImage,onClick:r,style:{cursor:"pointer"}},null,8,re)):h("",!0)],64))}},C=p(le,[["__scopeId","data-v-b6a661e1"]]),ce={},de={xmlns:"http://www.w3.org/2000/svg",width:"30",height:"30",viewBox:"0 0 30 30"};function ue(e,n){return a(),i("svg",de,n[0]||(n[0]=[l("path",{id:"\u8DEF\u5F84_135","data-name":"\u8DEF\u5F84 135",d:"M15,30A15,15,0,1,1,30,15,15.044,15.044,0,0,1,15,30ZM15,1.667A13.482,13.482,0,0,0,1.667,15,13.482,13.482,0,0,0,15,28.333,13.482,13.482,0,0,0,28.333,15,13.482,13.482,0,0,0,15,1.667ZM20.5,20a.833.833,0,0,1-1.333,0L10,10.833c-.333-.333-.667-.75-.333-1.167a1.014,1.014,0,0,1,1.333,0L20.333,19C20.583,19.25,20.75,19.75,20.5,20Zm-.167-9L11,20.333a.946.946,0,0,1-.667.25C9.5,20.5,9.667,19.5,10,19.167L19.167,10c.333-.333.75-.667,1.167-.333A1.012,1.012,0,0,1,20.333,11Z",fill:"red"},null,-1)]))}const fe=p(ce,[["render",ue]]);const _e={class:"banned-container"},me={class:"status-container"},ge={__name:"BannedView",props:{fileUrl:{type:String,required:!0}},setup(e){return(n,t)=>(a(),i("div",_e,[I(C),l("div",me,[t[0]||(t[0]=l("div",{class:"status-text"},"\u6587\u4EF6\u6D89\u5ACC\u8FDD\u89C4\uFF0C\u5DF2\u88AB\u5C01\u7981",-1)),I(fe,{class:"ban-icon"})])]))}},pe=p(ge,[["__scopeId","data-v-0e96f9af"]]),q="/assets/loading-icon-26fa4a1b.svg";const we={class:"download-container"},ye={class:"status-container"},ve={class:"status-text"},he={class:"file-size"},ke={key:0,class:"loading-icon",src:q},be={__name:"DownloadView",props:{fileUrl:{type:[Number,String],required:!0},easyFile:{type:Object,required:!0}},emits:["download"],setup(e){function n(t){return t<1024||t<1048576?(t/1024).toFixed(2)+" KB":t<1073741824?(t/1048576).toFixed(2)+" MB":(t/1073741824).toFixed(2)+" GB"}return(t,r)=>(a(),i("div",we,[I(C),l("div",ye,[l("div",ve,[e.fileUrl===0?(a(),i(T,{key:0},[F("\u52A0\u8F7D\u4E2D...")],64)):e.fileUrl===-1?(a(),i(T,{key:1},[F("\u6CA1\u6709\u627E\u5230\u8BE5\u6587\u4EF6")],64)):(a(),i(T,{key:2},[F(S("\u4E0B\u8F7D\u94FE\u63A5\u5DF2\u751F\u6210\uFF1A"+e.easyFile.name)+" ",1),l("div",he,S(n(e.easyFile.size)),1)],64))]),e.fileUrl===0?(a(),i("img",ke)):h("",!0)]),e.fileUrl!==0&&e.fileUrl!==-1?(a(),i("div",{key:0,class:"download-btn",onClick:r[0]||(r[0]=u=>t.$emit("download"))}," \u70B9\u51FB\u4E0B\u8F7D ")):h("",!0)]))}},Te=p(be,[["__scopeId","data-v-61bd5a39"]]);const xe={class:"jump-to-miniprogram"},Ee={__name:"MiniProgramRedirect",emits:["openMiniprogram"],setup(e){return(n,t)=>(a(),i("div",xe,[I(C),t[1]||(t[1]=l("div",{class:"status-container"},[l("div",{class:"status-text"},"\u6B63\u5728\u6253\u5F00\u300C\u7B80\u5355\u4E91\u94FE\u300D\u5C0F\u7A0B\u5E8F"),l("img",{class:"loading-icon",src:q})],-1)),l("div",{class:"open-miniprogram-btn",onClick:t[0]||(t[0]=r=>n.$emit("openMiniprogram"))}," \u6253\u5F00\u5C0F\u7A0B\u5E8F ")]))}},Ie=p(Ee,[["__scopeId","data-v-00839764"]]);const Ae={class:"file-container"},Me={key:0},Ve={key:1},Re=["src"],$e=["src"],Fe=["src"],Be={__name:"FileViewer",props:{fileUrl:{type:[Number,String],required:!0},fileType:{type:String,required:!0},easyFile:{type:Object,required:!0}},setup(e){const n=P(),t=g(null),r=G(null),u=async()=>{console.log("loadMarkdownView",f.fileType),f.fileType==="markdown"&&!r.value&&(r.value=H(()=>K(()=>import("./MarkdownView-ec6ecdc6.js"),["assets/MarkdownView-ec6ecdc6.js","assets/index-5b1ebc59.js","assets/index-ead66102.css","assets/MarkdownView-6d431ad1.css"])))},f=e;j(()=>{u()});const d=()=>{w.send({trigger:"button-click",page:"file-view",object:"home-button"}),n.push("/")};return(_,m)=>(a(),i("div",Ae,[e.fileUrl===0?(a(),i("div",Me,"\u52A0\u8F7D\u4E2D...")):e.fileUrl===-1?(a(),i("div",Ve,"\u6CA1\u6709\u627E\u5230\u8BE5\u6587\u4EF6")):e.fileType==="image"?(a(),i("img",{key:2,src:e.fileUrl},null,8,Re)):e.fileType==="video"?(a(),i("video",{key:3,src:e.fileUrl,ref_key:"videoElement",ref:t,controls:""},null,8,$e)):e.fileType==="markdown"?(a(),y(z,{key:4},{default:N(()=>[(a(),y(O(r.value),{"markdown-path":e.fileUrl,"page-title":e.easyFile.name},null,8,["markdown-path","page-title"]))]),fallback:N(()=>m[0]||(m[0]=[l("div",null,"\u52A0\u8F7D\u4E2D...",-1)])),_:1})):(a(),i("iframe",{key:5,class:"iframe",src:e.fileUrl,frameborder:"0"},null,8,Fe)),l("div",{class:"home-button",onClick:d},"EasyLink.cc")]))}},Ce=p(Be,[["__scopeId","data-v-b6e8c66d"]]);function De(){const e=X(),n=e.INTERSTITIAL_PLACEMENT_ID;return{tryRenderInterstitialAd:()=>{const r=e.getNextAd(n);if(r){console.log("[useInterstitialAd] Found ad data, attempting to render...");try{return window.TencentGDT&&window.TencentGDT.NATIVE&&typeof window.TencentGDT.NATIVE.renderAd=="function"?(window.TencentGDT.NATIVE.renderAd(r),e.consumeAd(n),console.log("[useInterstitialAd] Ad rendered successfully."),!0):(console.error("[useInterstitialAd] TencentGDT.NATIVE.renderAd is not available."),!1)}catch(u){return console.error("[useInterstitialAd] Error rendering ad:",u),e.consumeAd(n),!1}}else return console.log("[useInterstitialAd] No ad data available in queue. Attempting to load more..."),e.checkIsLoading(n)||e.loadAds(n),!1}}}const Ue={class:"file-view"},Se={__name:"EasyFileView",props:{relativeUrl:{type:String,required:!0}},setup(e){const n=e,{state:{fileUrl:t,fileType:r,easyFile:u,isDownload:f,isMobile:d,isBanned:_,isWebToMpRedirectEnable:m},action:{handleReport:k,handleOpenMiniProgram:b,handleDownload:A,initialize:M}}=te(n.relativeUrl),V=()=>k(Y,L),R=()=>{w.send({trigger:"button-click",page:"jump-to-mini-file-page",object:"jump-to-mini-btn"}),b()},$=()=>{w.send({trigger:"button-click",page:"download-page",object:"download-btn"}),A()},v=B(()=>!_.value&&!f.value&&!(d.value&&m.value)),{tryRenderInterstitialAd:D}=De(),x=g(!1);return j(()=>{v.value&&!x.value?(console.log("[EasyFileView] Viewer condition met and ad not rendered yet, calling tryRenderInterstitialAd..."),D()&&(x.value=!0)):v.value}),J(()=>n.relativeUrl,(o,s)=>{o!==s&&s!==void 0&&(console.log("[EasyFileView] View identifier changed, resetting ad render flag."),x.value=!1)},{immediate:!1}),Q(async()=>{console.log("[EasyFileView] Mounted"),await M(),f.value?w.send({trigger:"page-view",page:"download-page"}):d.value&&m.value?w.send({trigger:"page-view",page:"jump-to-mini-file-page"}):w.send({trigger:"page-view",page:"file-page"})}),(o,s)=>(a(),i("div",Ue,[c(_)?(a(),y(pe,{key:0,"file-url":c(t)},null,8,["file-url"])):(a(),i(T,{key:1},[c(f)?(a(),y(Te,{key:0,"file-url":c(t),"easy-file":c(u),onDownload:$},null,8,["file-url","easy-file"])):c(d)&&c(m)?(a(),y(Ie,{key:1,onOpenMiniprogram:R})):h("",!0),v.value?(a(),y(Ce,{key:2,"file-url":c(t),"file-type":c(r),"easy-file":c(u)},null,8,["file-url","file-type","easy-file"])):h("",!0),(a(),y(ie,{key:3,class:"report-icon",onClick:V}))],64))]))}},Pe=p(Se,[["__scopeId","data-v-89e92ecd"]]);export{Pe as default};
//# sourceMappingURL=EasyFileView-209b7cf7.js.map
